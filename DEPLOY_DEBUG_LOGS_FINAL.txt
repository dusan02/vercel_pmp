cd /var/www/premarketprice && \
echo "=== 1. GIT PULL ===" && \
git pull origin main && \
echo "" && \
echo "=== 2. REÅ TARTOVANIE ===" && \
pm2 restart premarketprice && \
sleep 5 && \
echo "" && \
echo "=== 3. PM2 STATUS ===" && \
pm2 list | grep premarketprice && \
echo "" && \
echo "=== 4. TEST API - Volanie /api/stocks?limit=5 ===" && \
curl -s "http://localhost:3000/api/stocks?limit=5" > /dev/null && \
echo "âœ… API volanie dokonÄenÃ©" && \
echo "" && \
echo "=== 5. POÄŒKANIE 3 SEKÃšND ===" && \
sleep 3 && \
echo "" && \
echo "=== 6. PM2 LOGY - hÄ¾adanie debug logov ===" && \
pm2 logs premarketprice --lines 200 --nostream 2>&1 | grep -i -E "(ðŸ“Š|âš ï¸|NVDA|GOOG|MSFT|marketCapDiff|calculatedPct|prevClose)" | tail -50 || echo "âš ï¸ Å½iadne relevantnÃ© logy" && \
echo "" && \
echo "=== 7. KONTROLA DB - marketCapDiff po API volanÃ­ ===" && \
DB="prisma/data/premarket.db" && \
sqlite3 "$DB" "SELECT symbol, lastMarketCap, lastMarketCapDiff, lastPrice, latestPrevClose FROM Ticker WHERE symbol IN ('NVDA', 'GOOG', 'MSFT') ORDER BY lastMarketCap DESC;" 2>&1 && \
echo "" && \
pm2 save && \
echo "" && \
echo "âœ… Hotovo! Skontroluj logy vyÅ¡Å¡ie."

