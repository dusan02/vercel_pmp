# üîç SKONTROLOVA≈§ PIPELINE A MANU√ÅLNE SPUSTI≈§

cd /var/www/earnings-table && \
echo "=== 1. AKTU√ÅLNY POƒåET Z√ÅZNAMOV ===" && \
sqlite3 modules/database/prisma/prod.db "SELECT COUNT(*) as pocet FROM final_report;" 2>/dev/null && \
echo "" && \
echo "=== 2. PM2 LOGY - earnings-cron (posledn√Ωch 100 riadkov, hƒæadanie pipeline) ===" && \
pm2 logs earnings-cron --lines 100 --nostream 2>&1 | grep -i -E "(pipeline|finnhub|polygon|fetch|load|data)" | tail -30 || echo "‚ö†Ô∏è ≈Ωiadne v√Ωsledky" && \
echo "" && \
echo "=== 3. SKONTROLOVA≈§, ƒåI EXISTUJE API ENDPOINT PRE MANU√ÅLNY START ===" && \
curl -s http://localhost:5555/api/health 2>/dev/null | head -5 || echo "‚ö†Ô∏è Health endpoint nefunguje" && \
echo "" && \
echo "=== 4. POƒåKA≈§ 1 MIN√öTU A SKONTROLOVA≈§ ZNOVA ===" && \
echo "ƒåak√°m 60 sek√∫nd na ƒèal≈°ie spustenie pipeline (ka≈æd√Ωch 5 min√∫t)..." && \
sleep 60 && \
sqlite3 modules/database/prisma/prod.db "SELECT COUNT(*) as pocet FROM final_report;" 2>/dev/null && \
echo "" && \
echo "=== 5. PM2 LOGY - earnings-cron (nov√©, posledn√Ωch 30 riadkov) ===" && \
pm2 logs earnings-cron --lines 30 --nostream 2>&1 | tail -20 && \
echo "" && \
echo "=== 6. AKTU√ÅLNY ƒåAS V NY ===" && \
TZ=America/New_York date && \
echo "" && \
echo "‚úÖ Hotovo!"

