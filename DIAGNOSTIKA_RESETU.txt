# üîç DIAGNOSTIKA RESETU TABULKY

## PROBL√âM:
- V≈°etky z√°znamy maj√∫ d√°tum `2000-01-01 01:00:00` (placeholder)
- reportDate je NULL alebo pr√°zdny
- Dnes je Dec 25 (Vianoce) - NIE JE pracovn√Ω de≈à (cron be≈æ√≠ len Po-Pi: 1-5)
- Cron schedule: `0 3 * * 1-5` = 03:00 NY (09:00 CET) len Po-Pi

## JEDEN PR√çKAZ (diagnostika):
```bash
cd /var/www/earnings-table && echo "=== 1. PM2 LOGY - earnings-cron (hƒæadanie 'clear' alebo 'reset') ===" && pm2 logs earnings-cron --lines 200 --nostream 2>&1 | grep -i -E "(clear|reset|03:00|daily|delete)" | tail -20 && echo "" && echo "=== 2. SQLITE - SKUTOƒåN√â HODNOTY reportDate ===" && sqlite3 modules/database/prisma/prod.db "SELECT symbol, reportDate, snapshotDate, datetime(createdAt, 'localtime') as created FROM final_report LIMIT 5;" 2>/dev/null && echo "" && echo "=== 3. SQLITE - POƒåET Z√ÅZNAMOV S NULL reportDate ===" && sqlite3 modules/database/prisma/prod.db "SELECT COUNT(*) as null_reportDate FROM final_report WHERE reportDate IS NULL;" 2>/dev/null && echo "" && echo "=== 4. AKTU√ÅLNY DE≈á V T√ù≈ΩDNI (1=pondelok, 5=piatok) ===" && TZ=America/New_York date +"%u" && echo "" && echo "=== 5. AKTU√ÅLNY DE≈á V T√ù≈ΩDNI (n√°zov) ===" && TZ=America/New_York date +"%A" && echo "" && echo "=== 6. CRON STATUS Z LOGOV ===" && pm2 logs earnings-cron --lines 100 --nostream 2>&1 | grep -i "daily clear" | tail -5
```

## RIE≈†ENIE - MANU√ÅLNY RESET:
```bash
cd /var/www/earnings-table && echo "=== MANU√ÅLNY RESET TABULKY ===" && sqlite3 modules/database/prisma/prod.db "DELETE FROM final_report; DELETE FROM finnhub_data; DELETE FROM polygon_data;" && echo "‚úÖ Tabuƒæky vymazan√©" && echo "" && echo "=== RESTART earnings-cron (aby naƒç√≠tal nov√© d√°ta) ===" && pm2 restart earnings-cron && sleep 3 && echo "" && echo "=== PM2 STATUS ===" && pm2 list | grep earnings-cron
```

