# üîê FIN√ÅLNE RIE≈†ENIE SSL PRE PREMARKETPRICE.COM

# === SITU√ÅCIA ===
# ‚úÖ earningstable.com - certifik√°t existuje a je obnoven√Ω
# ‚ùå premarketprice.com - certifik√°t zlyh√° kv√¥li firewall probl√©mu

# === KROK 1: Skontrolova≈• firewall ===
ufw status
# Alebo
iptables -L -n | grep -E "80|443"

# === KROK 2: Otvori≈• porty 80 a 443 (ak s√∫ zatvoren√©) ===
ufw allow 80/tcp
ufw allow 443/tcp
ufw reload

# === KROK 3: Skontrolova≈•, ƒçi Nginx poƒç√∫va na porte 80 ===
ss -tlnp | grep 80

# Mali by ste vidie≈•: LISTEN 0 511 *:80

# === KROK 4: Testova≈•, ƒçi port 80 je dostupn√Ω zvonka ===
# Z in√©ho poƒç√≠taƒça alebo cez online n√°stroj:
# curl http://premarketprice.com/.well-known/acme-challenge/test

# === KROK 5: Skontrolova≈• DNS propag√°ciu ===
dig premarketprice.com +short
# Mali by ste vidie≈•: 89.185.250.213

# === KROK 6: Sk√∫si≈• pou≈æi≈• DNS-01 challenge namiesto HTTP-01 ===
# Toto nevy≈æaduje otvoren√Ω port 80
certbot certonly --manual --preferred-challenges dns -d premarketprice.com -d www.premarketprice.com

# Certbot v√°m d√° TXT z√°znam, ktor√Ω mus√≠te prida≈• do DNS
# Po pridan√≠, stlaƒçte Enter a certbot dokonƒç√≠ verifik√°ciu

# === KROK 7: Alebo sk√∫si≈• znovu HTTP-01 po oprave firewallu ===
certbot certonly --nginx -d premarketprice.com -d www.premarketprice.com

# === KROK 8: Po √∫spe≈°nom vygenerovan√≠, skontrolova≈• ===
ls -la /etc/letsencrypt/live/premarketprice.com/

# Mali by ste vidie≈•:
# fullchain.pem
# privkey.pem

# === KROK 9: Skontrolova≈•, ƒçi Nginx pou≈æ√≠va spr√°vne cesty ===
nginx -T | grep -A 2 "ssl_certificate.*premarketprice"

# === KROK 10: Reload Nginx ===
systemctl reload nginx

# === KROK 11: Testova≈• HTTPS ===
curl -k https://premarketprice.com/api/health

