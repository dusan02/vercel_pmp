# 游댢 OPRAVI콗 HTTPS 502 - Kop칤rova콘 a spusti콘 na serveri

# === KROK 1: Skontrolova콘, 캜i existuj칰 SSL certifik치ty ===
ls -la /etc/letsencrypt/live/premarketprice.com/
ls -la /etc/letsencrypt/live/earningstable.com/

# Ak neexistuj칰, treba ich vygenerova콘

# === KROK 2: Skontrolova콘 HTTPS konfigur치ciu v Nginx ===
nginx -T | grep -A 10 "server_name.*premarketprice.com" | grep -A 5 "listen 443"

# === KROK 3: Testova콘 HTTPS priamo ===
curl -k https://localhost/api/health
# -k ignoruje SSL chyby

# === KROK 4: Skontrolova콘 Nginx error logy pre HTTPS ===
tail -30 /var/log/nginx/error.log | grep -i ssl

# === KROK 5: Do캜asne vypn칰콘 HTTPS redirect (pre testovanie) ===
# Upravi콘 Nginx konfigur치ciu - komentova콘 HTTPS redirect
# Alebo vytvori콘 do캜asn칰 HTTP verziu

# === KROK 6: Vygenerova콘 SSL certifik치ty (ak ch칳baj칰) ===
certbot certonly --nginx -d premarketprice.com -d www.premarketprice.com
certbot certonly --nginx -d earningstable.com -d www.earningstable.com

# === KROK 7: Ak certbot nie je nain코talovan칳 ===
apt update
apt install certbot python3-certbot-nginx -y

# === KROK 8: Po vygenerovan칤 certifik치tov, reload Nginx ===
systemctl reload nginx

# === KROK 9: Testova콘 HTTPS ===
curl -k https://premarketprice.com/api/health
curl -k https://earningstable.com/api/health

