# üîß Kompletn√© pr√≠kazy na opravu .env s√∫boru (bez nano)

## Spustite tieto pr√≠kazy na serveri:

```bash
cd /var/www/premarketprice

# 1. Nahradi≈• AUTH_SECRET
sed -i 's/AUTH_SECRET=YOUR_AUTH_SECRET_HERE/AUTH_SECRET=PmvYkCGSptpV153YHddjgQtcWRL0GdZJ00t0\/1VTyOw=/' .env

# 2. Odstr√°ni≈• duplik√°t NEXTAUTH_URL (odstr√°ni≈• prv√Ω v√Ωskyt pred Google OAuth sekciou)
sed -i '/^NEXTAUTH_URL=https:\/\/premarketprice\.com$/d' .env
# Potom prida≈• sp√§≈• na koniec (ak chcete, ale u≈æ tam je)
# echo "NEXTAUTH_URL=https://premarketprice.com" >> .env

# 3. Skontrolova≈• v√Ωsledok
grep -E "GOOGLE_CLIENT_ID|GOOGLE_CLIENT_SECRET|AUTH_SECRET|NEXTAUTH_URL" .env
```

---

## Alebo jeden pr√≠kaz na v≈°etko (najr√Ωchlej≈°ie):

```bash
cd /var/www/premarketprice && sed -i 's/AUTH_SECRET=YOUR_AUTH_SECRET_HERE/AUTH_SECRET=PmvYkCGSptpV153YHddjgQtcWRL0GdZJ00t0\/1VTyOw=/' .env && sed -i '/^NEXTAUTH_URL=https:\/\/premarketprice\.com$/d' .env && tail -10 .env
```

---

## Po oprave - nahradi≈• GOOGLE_CLIENT_SECRET:

**Ak u≈æ m√°te Client Secret, nahraƒète ho takto:**

```bash
# Nahraƒète YOUR_ACTUAL_SECRET_HERE va≈°√≠m skutoƒçn√Ωm secretom
sed -i 's/GOOGLE_CLIENT_SECRET=YOUR_CLIENT_SECRET_HERE/GOOGLE_CLIENT_SECRET=YOUR_ACTUAL_SECRET_HERE/' .env
```

**Pr√≠klad:**
```bash
sed -i 's/GOOGLE_CLIENT_SECRET=YOUR_CLIENT_SECRET_HERE/GOOGLE_CLIENT_SECRET=GOCSPX-abc123xyz456/' .env
```

---

## Kompletn√Ω pr√≠kaz (ak u≈æ m√°te Client Secret):

```bash
cd /var/www/premarketprice && \
sed -i 's/AUTH_SECRET=YOUR_AUTH_SECRET_HERE/AUTH_SECRET=PmvYkCGSptpV153YHddjgQtcWRL0GdZJ00t0\/1VTyOw=/' .env && \
sed -i 's/GOOGLE_CLIENT_SECRET=YOUR_CLIENT_SECRET_HERE/GOOGLE_CLIENT_SECRET=VA≈†_SKUTOƒåN√ù_SECRET/' .env && \
sed -i '/^NEXTAUTH_URL=https:\/\/premarketprice\.com$/d' .env && \
echo "‚úÖ Opraven√©!" && \
grep -E "GOOGLE_CLIENT_ID|GOOGLE_CLIENT_SECRET|AUTH_SECRET|NEXTAUTH_URL" .env
```

---

## Kontrola po oprave:

```bash
# Skontrolova≈• v≈°etky OAuth nastavenia
grep -E "GOOGLE|AUTH|NEXTAUTH" .env

# Skontrolova≈•, ƒçi nie s√∫ duplik√°ty
grep -c "NEXTAUTH_URL" .env
# Mali by ste vidie≈•: 1 (len jeden v√Ωskyt)
```

---

## Re≈°tart aplik√°cie s nov√Ωmi environment variables:

```bash
pm2 restart all --update-env
```

Alebo √∫pln√Ω re≈°tart:

```bash
pm2 delete all
pm2 start ecosystem.config.js --env production
pm2 save
```

---

## Overenie, ƒçi funguje:

```bash
# Skontrolova≈• logy
pm2 logs premarketprice --lines 20 | grep -i "oauth\|google\|auth"

# Test API
curl http://localhost:3000/api/auth/providers
```


