# üîß OPRAVI≈§ PORT 3001 ‚Üí 3000 - Kop√≠rova≈• a spusti≈• na serveri

# === KROK 1: Zastavi≈• aktu√°lny proces ===
cd /var/www/premarketprice
pm2 stop premarketprice
pm2 delete premarketprice

# === KROK 2: Spusti≈• s explicitn√Ωm PORT=3000 ===
PORT=3000 pm2 start ecosystem.config.js --only premarketprice --env production

# === KROK 3: Skontrolova≈• logy ===
sleep 5
pm2 logs premarketprice --lines 10

# Mali by ste vidie≈•: "üöÄ Next.js server ready on http://localhost:3000"

# === KROK 4: Skontrolova≈• porty (pou≈æi≈• ss namiesto netstat) ===
ss -tlnp | grep -E "3000|3001"

# Mali by ste vidie≈•: 127.0.0.1:3000 (nie 3001)

# === KROK 5: Spusti≈• workers ===
pm2 start ecosystem.config.js --only pmp-polygon-worker --env production
pm2 start ecosystem.config.js --only pmp-bulk-preloader --env production

# === KROK 6: Skontrolova≈• v≈°etky procesy ===
pm2 status

# Mali by ste vidie≈•:
# - premarketprice (online)
# - pmp-polygon-worker (online)
# - pmp-bulk-preloader (online alebo waiting)

# === KROK 7: Ulo≈æi≈• ===
pm2 save

# === KROK 8: Skontrolova≈• logy workers ===
pm2 logs pmp-polygon-worker --lines 10
pm2 logs pmp-bulk-preloader --lines 10

