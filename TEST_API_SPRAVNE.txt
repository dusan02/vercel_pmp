cd /var/www/premarketprice && \
echo "=== 1. TEST: NesprÃ¡vne volanie (oÄakÃ¡va sa 400) ===" && \
curl -i "http://localhost:3000/api/stocks?limit=10" 2>&1 | head -n 5 && \
echo "" && \
echo "=== 2. TEST: SprÃ¡vne volanie A - konkrÃ©tne tickery ===" && \
curl -s "http://localhost:3000/api/stocks?tickers=NVDA,GOOG,MSFT" > /dev/null && \
echo "âœ… API volanie dokonÄenÃ©" && \
echo "" && \
echo "=== 3. POÄŒKANIE 2 SEKUNDY ===" && \
sleep 2 && \
echo "" && \
echo "=== 4. PM2 LOGY - debug logy ===" && \
pm2 logs premarketprice --lines 300 --nostream 2>&1 | grep -E "(ðŸ”|ðŸ“Š|âš ï¸|âœ…|NVDA|GOOG|MSFT|marketCapDiff|calculatedPct|Method|Persisted)" | tail -120 || echo "âš ï¸ Å½iadne relevantnÃ© logy" && \
echo "" && \
echo "=== 5. KONTROLA DB - marketCapDiff po API volanÃ­ ===" && \
DB="prisma/data/premarket.db" && \
sqlite3 "$DB" "SELECT symbol, lastMarketCap, lastMarketCapDiff, lastPrice, latestPrevClose, sharesOutstanding FROM Ticker WHERE symbol IN ('NVDA', 'GOOG', 'MSFT') ORDER BY lastMarketCap DESC;" 2>&1 && \
echo "" && \
echo "âœ… Hotovo!"

