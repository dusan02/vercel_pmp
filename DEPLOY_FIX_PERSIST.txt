cd /var/www/premarketprice && \
echo "=== 1. GIT PULL ===" && \
git pull origin main && \
echo "" && \
echo "=== 2. REÅ TARTOVANIE ===" && \
pm2 restart premarketprice && \
sleep 5 && \
echo "" && \
echo "=== 3. PM2 STATUS ===" && \
pm2 list | grep premarketprice && \
echo "" && \
echo "=== 4. TEST API - tickers NVDA,GOOG,MSFT ===" && \
curl -s "http://localhost:3000/api/stocks?tickers=NVDA,GOOG,MSFT" > /dev/null && \
echo "âœ… API volanie dokonÄenÃ©" && \
echo "" && \
echo "=== 5. POÄŒKANIE 2 SEKUNDY ===" && \
sleep 2 && \
echo "" && \
echo "=== 6. PM2 LOGY - debug ===" && \
pm2 logs premarketprice --lines 300 --nostream 2>&1 | grep -E "(ðŸ”|ðŸ“Š|âš ï¸|âœ…|NVDA|GOOG|MSFT|marketCapDiff|calculatedPct|Method|Persisted|Completed)" | tail -120 || echo "âš ï¸ Å½iadne relevantnÃ© logy" && \
echo "" && \
echo "=== 7. KONTROLA DB ===" && \
DB="prisma/data/premarket.db" && \
sqlite3 "$DB" "SELECT symbol, lastMarketCap, lastMarketCapDiff, lastPrice, latestPrevClose, sharesOutstanding FROM Ticker WHERE symbol IN ('NVDA', 'GOOG', 'MSFT') ORDER BY lastMarketCap DESC;" 2>&1 && \
echo "" && \
pm2 save && \
echo "" && \
echo "âœ… Hotovo!"

