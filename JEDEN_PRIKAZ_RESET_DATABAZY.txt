# üóëÔ∏è JEDEN PR√çKAZ - Vymaza≈• tabuƒæky a resetova≈• datab√°zu (ste v /var/www/earnings-table)

echo "=== 1. Zastavenie procesov ===" && pm2 stop earnings-cron earnings-table && echo "" && echo "=== 2. Z√°loha datab√°zy ===" && cp /var/www/earnings-table/modules/database/prisma/prod.db /var/www/earnings-table/modules/database/prisma/prod.db.backup.$(date +%Y%m%d_%H%M%S) 2>/dev/null && echo "‚úÖ Z√°loha vytvoren√°" && echo "" && echo "=== 3. Vymazanie datab√°zy ===" && rm /var/www/earnings-table/modules/database/prisma/prod.db && echo "‚úÖ Datab√°za vymazan√°" && echo "" && echo "=== 4. Vytvorenie novej datab√°zy cez Prisma ===" && cd /var/www/earnings-table/modules/database && npx prisma db push --accept-data-loss && echo "‚úÖ Nov√° datab√°za vytvoren√°" && echo "" && echo "=== 5. Spustenie earnings-table ===" && cd /var/www/earnings-table && pm2 start earnings-table && echo "" && echo "=== 6. Spustenie earnings-cron ===" && pm2 start earnings-cron && echo "" && echo "=== 7. Ulo≈æenie PM2 konfigur√°cie ===" && pm2 save && echo "" && echo "=== 8. ƒåakanie 5 sek√∫nd ===" && sleep 5 && echo "" && echo "=== 9. PM2 status ===" && pm2 status && echo "" && echo "=== 10. Test API ===" && curl -s http://localhost:5555/api/health | head -3

