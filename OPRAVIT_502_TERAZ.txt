# 游댢 OPRAVI콗 502 BAD GATEWAY PRE EARNINGSTABLE.COM - Kop칤rova콘 a spusti콘

# === KROK 1: Skontrolova콘, 캜i server be쮂 ===
ss -tlnp | grep 3000
curl http://localhost:3000/api/health

# === KROK 2: Skontrolova콘, ktor칰 Nginx konfigur치ciu pou쮂셨a ===
nginx -T 2>&1 | grep "configuration file"

# === KROK 3: Skontrolova콘 upstream v aktu치lnej konfigur치cii ===
nginx -T | grep -A 5 "upstream app_servers"

# Mali by ste vidie콘: server 127.0.0.1:3000
# Ak nie, toto je probl칠m!

# === KROK 4: Skontrolova콘 earningstable.com server block ===
nginx -T | grep -B 5 -A 20 "server_name.*earningstable"

# === KROK 5: Skontrolova콘 Nginx error logy ===
tail -30 /var/log/nginx/error.log | grep -i earningstable

# === KROK 6: Skontrolova콘, 캜i existuj칰 konfigur치cie v sites-enabled ===
ls -la /etc/nginx/sites-enabled/
cat /etc/nginx/sites-enabled/* 2>/dev/null | grep -A 10 earningstable

# === KROK 7: Ak Nginx nepou쮂셨a na코u konfigur치ciu, skop칤rova콘 ju ===
# N치코 nginx.conf je v: /var/www/premarketprice/nginx.conf
# Skop칤rova콘 do /etc/nginx/sites-available/
cp /var/www/premarketprice/nginx.conf /etc/nginx/sites-available/premarketprice.conf

# === KROK 8: Vytvori콘 symlink (ak pou쮂셨a sites-enabled) ===
ln -sf /etc/nginx/sites-available/premarketprice.conf /etc/nginx/sites-enabled/premarketprice.conf

# === KROK 9: Alebo upravi콘 hlavn칳 nginx.conf ===
# Ak Nginx pou쮂셨a /etc/nginx/nginx.conf, mus칤me upravi콘 ten s칰bor
# Alebo include na코u konfigur치ciu:
# include /var/www/premarketprice/nginx.conf;

# === KROK 10: Testova콘 konfigur치ciu ===
nginx -t

# === KROK 11: Reload Nginx ===
systemctl reload nginx

# === KROK 12: Testova콘 ===
curl -k https://earningstable.com/api/health
curl -k https://www.earningstable.com/api/health

# Mali by ste dosta콘 JSON (nie 502)

