# 游댠 OPRAVI콗 IPTABLES FIREWALL - Kop칤rova콘 a spusti콘 na serveri

# === KROK 1: Skontrolova콘 aktu치lne iptables pravidl치 ===
iptables -L -n -v | head -30

# === KROK 2: Skontrolova콘, 캜i porty 80 a 443 s칰 blokovan칠 ===
iptables -L -n | grep -E "80|443"

# === KROK 3: Prida콘 pravidl치 pre porty 80 a 443 ===
iptables -I INPUT -p tcp --dport 80 -j ACCEPT
iptables -I INPUT -p tcp --dport 443 -j ACCEPT

# === KROK 4: Skontrolova콘, 캜i pravidl치 s칰 pridan칠 ===
iptables -L -n | grep -E "80|443"

# Mali by ste vidie콘:
# ACCEPT tcp -- 0.0.0.0/0 0.0.0.0/0 tcp dpt:80
# ACCEPT tcp -- 0.0.0.0/0 0.0.0.0/0 tcp dpt:443

# === KROK 5: Ulo쬴콘 pravidl치 (aby sa zachovali po re코tarte) ===
# Debian/Ubuntu:
iptables-save > /etc/iptables/rules.v4

# Alebo ak pou쮂셨ate netfilter-persistent:
apt install iptables-persistent -y
netfilter-persistent save

# === KROK 6: Sk칰si콘 znovu certbot ===
certbot certonly --nginx -d premarketprice.com -d www.premarketprice.com

# === KROK 7: Ak st치le zlyh치, sk칰si콘 DNS-01 challenge ===
# (Pozri PRIDAT_DNS_TXT.txt)

