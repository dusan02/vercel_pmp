cd /var/www/premarketprice && \
DB="prisma/data/premarket.db" && \
echo "=== KONTROLA: Hodnoty v DB pre veľké spoločnosti ===" && \
echo "" && \
echo "=== 1. NVDA ===" && \
sqlite3 "$DB" "SELECT 
  symbol,
  lastPrice,
  latestPrevClose,
  lastChangePct,
  lastMarketCap,
  lastMarketCapDiff,
  sharesOutstanding,
  CASE 
    WHEN lastPrice > 0 AND latestPrevClose > 0 AND sharesOutstanding > 0 THEN '✅ Môže z shares'
    WHEN lastMarketCap > 0 AND lastChangePct IS NOT NULL AND lastChangePct != 0 THEN '✅ Môže z marketCap/pctChange'
    ELSE '❌ Chýbajú dáta'
  END as moze_pocitat,
  CASE 
    WHEN sharesOutstanding > 0 THEN ROUND((lastPrice - latestPrevClose) * sharesOutstanding / 1000000000, 2)
    WHEN lastMarketCap > 0 AND lastChangePct IS NOT NULL THEN ROUND(lastMarketCap * lastChangePct / 100, 2)
    ELSE NULL
  END as vypocitany_capDiff
FROM Ticker 
WHERE symbol = 'NVDA';" 2>&1 && \
echo "" && \
echo "=== 2. GOOG ===" && \
sqlite3 "$DB" "SELECT 
  symbol,
  lastPrice,
  latestPrevClose,
  lastChangePct,
  lastMarketCap,
  lastMarketCapDiff,
  sharesOutstanding,
  CASE 
    WHEN lastPrice > 0 AND latestPrevClose > 0 AND sharesOutstanding > 0 THEN '✅ Môže z shares'
    WHEN lastMarketCap > 0 AND lastChangePct IS NOT NULL AND lastChangePct != 0 THEN '✅ Môže z marketCap/pctChange'
    ELSE '❌ Chýbajú dáta'
  END as moze_pocitat,
  CASE 
    WHEN sharesOutstanding > 0 THEN ROUND((lastPrice - latestPrevClose) * sharesOutstanding / 1000000000, 2)
    WHEN lastMarketCap > 0 AND lastChangePct IS NOT NULL THEN ROUND(lastMarketCap * lastChangePct / 100, 2)
    ELSE NULL
  END as vypocitany_capDiff
FROM Ticker 
WHERE symbol = 'GOOG';" 2>&1 && \
echo "" && \
echo "=== 3. MSFT ===" && \
sqlite3 "$DB" "SELECT 
  symbol,
  lastPrice,
  latestPrevClose,
  lastChangePct,
  lastMarketCap,
  lastMarketCapDiff,
  sharesOutstanding,
  CASE 
    WHEN lastPrice > 0 AND latestPrevClose > 0 AND sharesOutstanding > 0 THEN '✅ Môže z shares'
    WHEN lastMarketCap > 0 AND lastChangePct IS NOT NULL AND lastChangePct != 0 THEN '✅ Môže z marketCap/pctChange'
    ELSE '❌ Chýbajú dáta'
  END as moze_pocitat,
  CASE 
    WHEN sharesOutstanding > 0 THEN ROUND((lastPrice - latestPrevClose) * sharesOutstanding / 1000000000, 2)
    WHEN lastMarketCap > 0 AND lastChangePct IS NOT NULL THEN ROUND(lastMarketCap * lastChangePct / 100, 2)
    ELSE NULL
  END as vypocitany_capDiff
FROM Ticker 
WHERE symbol = 'MSFT';" 2>&1 && \
echo "" && \
echo "✅ Hotovo!"

