# 游댏 VYGENEROVA콗 SSL CERTIFIK츼TY - Kop칤rova콘 a spusti콘 na serveri

# === KROK 1: Skontrolova콘, 캜i certbot je nain코talovan칳 ===
which certbot || echo "Certbot nie je nain코talovan칳"

# === KROK 2: In코talova콘 certbot (ak nie je nain코talovan칳) ===
apt update
apt install certbot python3-certbot-nginx -y

# === KROK 3: Skontrolova콘, 캜i porty 80 a 443 s칰 otvoren칠 ===
ss -tlnp | grep -E "80|443"

# Mali by ste vidie콘:
# LISTEN 0 511 *:80
# LISTEN 0 511 *:443

# === KROK 4: Vygenerova콘 certifik치ty pre premarketprice.com ===
certbot certonly --nginx -d premarketprice.com -d www.premarketprice.com

# Certbot sa sp칳ta na email - zadajte svoj email
# Certbot sa sp칳ta, 캜i s칰hlas칤te s podmienkami - zadajte 'Y'
# Certbot sa sp칳ta, 캜i chcete zdie쬬콘 email - zadajte 'Y' alebo 'N'

# === KROK 5: Vygenerova콘 certifik치ty pre earningstable.com ===
certbot certonly --nginx -d earningstable.com -d www.earningstable.com

# === KROK 6: Skontrolova콘, 캜i certifik치ty existuj칰 ===
ls -la /etc/letsencrypt/live/premarketprice.com/
ls -la /etc/letsencrypt/live/earningstable.com/

# Mali by ste vidie콘:
# fullchain.pem
# privkey.pem

# === KROK 7: Skontrolova콘 Nginx konfigur치ciu ===
nginx -t

# === KROK 8: Reload Nginx ===
systemctl reload nginx

# === KROK 9: Testova콘 HTTPS ===
curl -k https://premarketprice.com/api/health
curl -k https://earningstable.com/api/health

# === KROK 10: Testova콘 v prehliada캜i ===
# Otvorte: https://premarketprice.com
# Otvorte: https://earningstable.com

# === POZN츼MKA: Ak certbot zlyh치 ===
# Mo쬹칠 pr칤캜iny:
# - DNS z치znamy e코te nie s칰 propagovan칠
# - Port 80 je blokovan칳 firewallom
# - DNSSEC probl칠my

# V takom pr칤pade m칪쬰te do캜asne vypn칰콘 HTTPS redirect (pozri DOCASNE_VYPNUT_HTTPS.txt)

