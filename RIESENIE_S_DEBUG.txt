# 游댢 RIEENIE S DEBUG V칗PISOM - Kop칤rova콘 a spusti콘 na serveri

# === KROK 1: Skontrolova콘, 캜i port 3000 nie je obsaden칳 ===
ss -tlnp | grep 3000

# Ak je obsaden칳, zisti콘 ktor칳m procesom:
# lsof -i :3000
# alebo
# fuser 3000/tcp

# === KROK 2: Skontrolova콘 .env s칰bor ===
cd /var/www/premarketprice
cat .env

# === KROK 3: Aktualizova콘 server.ts na serveri ===
# Mus칤te nahra콘 nov칳 server.ts s debug v칳pisom
# Alebo upravi콘 priamo na serveri:
# nano server.ts
# N치js콘 riadok: const port = parseInt(process.env.PORT || '3000', 10);
# Zmeni콘 na: const port = process.env.PORT ? parseInt(process.env.PORT, 10) : 3000;

# === KROK 4: Zastavi콘 a re코tartova콘 ===
pm2 stop premarketprice
pm2 delete premarketprice
pm2 start ecosystem.config.js --only premarketprice --env production

# === KROK 5: Skontrolova콘 debug v칳pis ===
sleep 10
pm2 logs premarketprice --lines 20

# H쬬da콘:
# 游댌 DEBUG: process.env.PORT = 3000 (alebo undefined)
# 游댌 DEBUG: Using port = 3000 (alebo 3001)

# === KROK 6: Ak process.env.PORT je undefined ===
# Probl칠m je v PM2 - nepreber치 environment premenn칠
# Rie코enie: Vytvori콘 .env s칰bor a pou쬴콘 dotenv alebo explicitne nastavi콘 v ecosystem.config.js

