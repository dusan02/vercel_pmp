# 游댢 OPRAVI콗 502 BAD GATEWAY PRE EARNINGSTABLE.COM

# === KROK 1: Skontrolova콘, 캜i server be쮂 na porte 3000 ===
ss -tlnp | grep 3000

# Mali by ste vidie콘: LISTEN 0 511 *:3000

# === KROK 2: Testova콘 priame pripojenie ===
curl http://localhost:3000/api/health

# Mali by ste dosta콘 JSON odpove캞 (nie 502)

# === KROK 3: Skontrolova콘, ktor칰 Nginx konfigur치ciu pou쮂셨a ===
nginx -T 2>&1 | grep "configuration file"

# === KROK 4: Skontrolova콘 upstream pre earningstable.com ===
nginx -T | grep -A 10 "server_name.*earningstable" | head -20

# === KROK 5: Skontrolova콘, 캜i Nginx pou쮂셨a na코u konfigur치ciu ===
# N치코 nginx.conf je v: /var/www/premarketprice/nginx.conf
# Nginx m칪쬰 pou쮂셨a콘: /etc/nginx/nginx.conf alebo /etc/nginx/sites-enabled/

ls -la /etc/nginx/sites-enabled/
cat /etc/nginx/sites-enabled/* | grep -A 5 earningstable

# === KROK 6: Skontrolova콘 Nginx error logy ===
tail -30 /var/log/nginx/error.log

# H쬬da콘 chyby t칳kaj칰ce sa:
# - "connection refused"
# - "upstream"
# - "earningstable"

# === KROK 7: Skontrolova콘, 캜i earningstable.com HTTPS blok pou쮂셨a spr치vny upstream ===
nginx -T | grep -B 5 -A 15 "server_name.*earningstable.com"

# Mali by ste vidie콘:
# proxy_pass http://app_servers;
# A upstream app_servers by malo by콘: server 127.0.0.1:3000;

# === KROK 8: Ak Nginx nepou쮂셨a na코u konfigur치ciu, skop칤rova콘 ju ===
# Mo쬹os콘 A: Skop칤rova콘 do sites-enabled
# cp /var/www/premarketprice/nginx.conf /etc/nginx/sites-available/premarketprice
# ln -s /etc/nginx/sites-available/premarketprice /etc/nginx/sites-enabled/

# Mo쬹os콘 B: Upravi콘 existuj칰cu konfigur치ciu
# nano /etc/nginx/sites-enabled/default
# Alebo
# nano /etc/nginx/nginx.conf

# === KROK 9: Testova콘 konfigur치ciu ===
nginx -t

# === KROK 10: Reload Nginx ===
systemctl reload nginx

# === KROK 11: Testova콘 HTTPS ===
curl -k https://earningstable.com/api/health
curl -k https://www.earningstable.com/api/health

# Mali by ste dosta콘 JSON odpove캞 (nie 502)

